!function(t,e){var n;if(!t.getSelection&&e.selection){n=null,t.getSelection=function(){return null!=n?n:n=new r},e.createRange=function(){return new Range},e.attachEvent("onkeydown",function(){return t.getSelection().setRangeAt(0,new Range(!0))}),e.attachEvent("onselectionchange",function(){return t.getSelection().setRangeAt(0,new Range(!0))}),t.Range=function(){function t(t){t?this.range=e.selection.createRange():(this.range=e.body.createTextRange(),this.collapse(!0)),this.init()}return t.END_TO_END="EndToEnd",t.END_TO_START="EndToStart",t.START_TO_END="StartToEnd",t.START_TO_START="StartToStart",t.prototype.init=function(){var t,e,n,r,i,a;return e=this.range.parentElement(),this.commonAncestorContainer=e,this.collapsed=0===this.compareBoundaryPoints("StartToEnd",this),a=this.range.duplicate(),a.moveToElementText(e),t=this.range.text.length>0?0:1,i=o.findLength("StartToStart",a,this.range),n=o.findNodeByPos(e,i,t),this.startContainer=n.el,this.startOffset=n.offset,r=o.findLength("StartToEnd",a,this.range),n=o.findNodeByPos(e,r,1),this.endContainer=n.el,this.endOffset=n.offset},t.prototype.select=function(){return this.range.select()},t.prototype.setStart=function(t,e){var n;return o.getText(t).length>=e&&e>=0?(3===t.nodeType&&(n=this.range.duplicate(),n.moveToElementText(t.parentNode),n.moveStart("character",e)),-1===this.range.compareEndPoints("StartToEnd",n)&&this.range.setEndPoint("EndToStart",n),this.range.setEndPoint("StartToStart",n)):void 0},t.prototype.setEnd=function(t,e){var n;return o.getText(t).length>=e&&e>=0?(3===t.nodeType&&(n=this.range.duplicate(),n.moveToElementText(t.parentNode),n.moveStart("character",e)),1===this.range.compareEndPoints("EndToStart",n)&&this.range.setEndPoint("StartToStart",n),this.range.setEndPoint("EndToStart",n)):void 0},t.prototype.selectNodeContents=function(t){return this.range.moveToElementText(t)},t.prototype.collapse=function(t){return t?this.range.setEndPoint("EndToStart",this.range):this.range.setEndPoint("StartToEnd",this.range)},t.prototype.compareBoundaryPoints=function(t,e){return this.range.compareEndPoints(t,e.range)},t.prototype.cloneRange=function(){var e;return e=new t,e.range=this.range.duplicate(),e.init(),e},t.prototype.detach=function(){return delete this.range},t.prototype.getBoundingClientRect=function(){var t,e;return e=this.range.getBoundingClientRect(),t={width:e.right-e.left,height:e.bottom-e.top,left:e.left,right:e.right,bottom:e.bottom,top:e.top}},t.prototype.toString=function(){return this.range.text||""},t}();var r;r=function(){function t(){this.selection=e.selection,this.ranges=[],this.init()}return t.prototype.init=function(){var t,e,n,r,o;return this.rangeCount=this.ranges.length,this.rangeCount?(e=this.ranges[0],null==this.prev&&(this.prev=e),0===e.compareBoundaryPoints(Range.END_TO_END,this.prev)?(r=["end","start"],t=r[0],n=r[1]):(o=["start","end"],t=o[0],n=o[1]),this.anchorNode=e[""+t+"Container"],this.anchorOffset=e[""+t+"Offset"],this.focusNode=e[""+n+"Container"],this.focusOffset=e[""+n+"Offset"],this.isCollapsed=this.anchorNode===this.focusNode):void 0},t.prototype.getRangeAt=function(t){return this.ranges[t]},t.prototype.setRangeAt=function(t,e){return this.prev=this.ranges[t],this.ranges[t]=e,this.init()},t.prototype.removeAllRanges=function(){return this.ranges=[],this.init()},t.prototype.addRange=function(t){var e,n,r,o,i;for(this.ranges.push(t),this.init(),o=this.ranges,i=[],n=0,r=o.length;r>n;n++)e=o[n],i.push(e.select());return i},t.prototype.deleteFromDocument=function(){return this.selection.clear()},t.prototype.toString=function(){return this.ranges[0].toString()},t}();var o;o={stripLineBreaks:function(t){return t.replace(/\r\n/g,"")},getText:function(t){return t.innerText||t.nodeValue},findLength:function(t,e,n){var r;switch(r=e.duplicate(),t){case"StartToStart":r.setEndPoint("EndToStart",n);break;case"StartToEnd":r.setEndPoint("EndToEnd",n)}return o.stripLineBreaks(r.text).length},findNodeByPos:function(t,e,n){var r,o;return null==n&&(n=0),o={length:0,el:t,offset:0},(r=function(t,e,n,o){var i,a,s,h,g;for(h=t.childNodes,g=[],a=0,s=h.length;s>a;a++)if(i=h[a],!o.found)if(3===i.nodeType){if(o.length+i.length+n>e){o.found=!0,o.el=i,o.offset=e-o.length;break}g.push(o.length+=i.length)}else g.push(r(i,e,n,o));return g})(t,e,n,o),o}}}}(window,document);