!function(t,e){var n;if(!t.getSelection&&e.selection){n=null,t.getSelection=function(){return null!=n?n:n=new o},e.createRange=function(){return new r},e.attachEvent("onselectionchange",function(){return t.getSelection().setRangeAt(0,new r(!0))});var r;r=function(){function t(t){t?this.range=e.selection.createRange():(this.range=e.body.createTextRange(),this.collapse(!0)),this.init()}return t.END_TO_END="EndToEnd",t.END_TO_START="EndToStart",t.START_TO_END="StartToEnd",t.START_TO_START="StartToStart",t.prototype.init=function(){var t,e,n,r,o,i;return e=this.range.parentElement(),this.commonAncestorContainer=e,this.collapsed=0===this.compareBoundaryPoints("StartToEnd",this),i=this.range.duplicate(),i.moveToElementText(e),t=this.range.text.length>0?0:1,i.setEndPoint("EndToStart",this.range),o=this.stripLineBreaks(i.text),n=this.findNodeByPos(e,o.length,t),this.startContainer=n.el,this.startOffset=n.offset,i.setEndPoint("EndToEnd",this.range),r=this.stripLineBreaks(i.text),n=this.findNodeByPos(e,r.length,1),this.endContainer=n.el,this.endOffset=n.offset},t.prototype.select=function(){return this.range.select()},t.prototype.stripLineBreaks=function(t){return t.replace(/\r\n/g,"")},t.prototype.findNodeByPos=function(t,e,n){var r,o;return null==n&&(n=0),o={length:0,el:0,offset:0},(r=function(t,e,n,o){var i,s,a,h,u;for(h=t.childNodes,u=[],s=0,a=h.length;a>s;s++)if(i=h[s],!o.found)if(3===i.nodeType){if(o.length+i.length+n>e){o.found=!0,o.el=i,o.offset=e-o.length;break}u.push(o.length+=i.length)}else u.push(r(i,e,n,o));return u})(t,e,n,o),o},t.prototype.getText=function(t){return t.innerText||t.nodeValue},t.prototype.setStart=function(t,e){var n;return this.getText(t).length>=e&&e>=0?(n=this.range.duplicate(),3===t.nodeType&&(n.moveToElementText(t.parentNode),n.moveStart("character",e)),-1===this.range.compareEndPoints("StartToEnd",n)&&this.range.setEndPoint("EndToStart",n),this.range.setEndPoint("StartToStart",n)):void 0},t.prototype.setEnd=function(t,e){var n;return this.getText(t).length>=e&&e>=0?(n=this.range.duplicate(),3===t.nodeType&&(n.moveToElementText(t.parentNode),n.moveStart("character",e)),1===this.range.compareEndPoints("EndToStart",n)&&this.range.setEndPoint("StartToStart",n),this.range.setEndPoint("EndToStart",n)):void 0},t.prototype.selectNodeContents=function(t){return this.range.moveToElementText(t)},t.prototype.collapse=function(t){return t?this.range.setEndPoint("EndToStart",this.range):this.range.setEndPoint("StartToEnd",this.range)},t.prototype.compareBoundaryPoints=function(t,e){return this.range.compareEndPoints(t,e.range)},t.prototype.toString=function(){return this.range.text||""},t}();var o;o=function(){function t(){this.selection=e.selection,this.ranges=[],this.init()}return t.prototype.init=function(){var t,e,n,o,i;return this.rangeCount=this.ranges.length,this.rangeCount?(e=this.ranges[0],null==this.prev&&(this.prev=e),0===e.compareBoundaryPoints(r.END_TO_END,this.prev)?(o=["end","start"],t=o[0],n=o[1]):(i=["start","end"],t=i[0],n=i[1]),this.anchorNode=e[""+t+"Container"],this.anchorOffset=e[""+t+"Offset"],this.focusNode=e[""+n+"Container"],this.focusOffset=e[""+n+"Offset"]):void 0},t.prototype.getRangeAt=function(t){return this.ranges[t]},t.prototype.setRangeAt=function(t,e){return this.prev=this.ranges[t],this.ranges[t]=e,this.init()},t.prototype.removeAllRanges=function(){return this.ranges=[],this.init()},t.prototype.addRange=function(t){var e,n,r,o,i;for(this.ranges.push(t),this.init(),o=this.ranges,i=[],n=0,r=o.length;r>n;n++)e=o[n],i.push(e.select());return i},t}()}}(window,document);