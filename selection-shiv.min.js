!function(t,e){if(!t.getSelection&&e.selection){t.getSelection=function(){return new i},e.createRange=function(){return new n};var n;n=function(){function t(t){var e,n,i,o,r,s;this.selection=t,this.range=this.selection.createRange(),n=this.range.parentElement(),this.commonAncestorContainer=n,s=this.range.duplicate(),s.moveToElementText(n),e=this.range.text.length>0?0:1,s.setEndPoint("EndToStart",this.range),r=this.stripLineBreaks(s.text),i=this.findNodeByPos(n,r.length,e),this.startContainer=i.el,this.startOffset=i.offset,s.setEndPoint("EndToEnd",this.range),o=this.stripLineBreaks(s.text),i=this.findNodeByPos(n,o.length,1),this.endContainer=i.el,this.endOffset=i.offset}return t.prototype.stripLineBreaks=function(t){return t.replace(/\r\n/g,"")},t.prototype.findNodeByPos=function(t,e,n){var i,o;return null==n&&(n=0),o={length:0,el:0,offset:0},(i=function(t,e,n,o){var r,s,h,f,a;for(f=t.childNodes,a=[],s=0,h=f.length;h>s;s++)if(r=f[s],!o.found)if(3===r.nodeType){if(o.length+r.length+n>e){o.found=!0,o.el=r,o.offset=e-o.length;break}a.push(o.length+=r.length)}else a.push(i(r,e,n,o));return a})(t,e,n,o),o},t}();var i;i=function(){function t(){this.rangeCount=1,this.selection=e.selection,this.range=new n(this.selection)}return t.prototype.getRangeAt=function(){return this.range},t}()}}(window,document);