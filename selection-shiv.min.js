!function(t,e){if(!t.getSelection&&e.selection){t.getSelection=function(){return new r},e.createRange=function(){return new n};var n;n=function(){function t(t){var e,n,r,o,i,s;this.selection=t,this.range=this.selection.createRange(),n=this.range.parentElement(),this.commonAncestorContainer=n,s=this.range.duplicate(),s.moveToElementText(n),e=this.range.text.length>0?0:1,s.setEndPoint("EndToStart",this.range),i=this.stripLineBreaks(s.text),r=this.findNodeByPos(n,i.length,e),this.startContainer=r.el,this.startOffset=r.offset,s.setEndPoint("EndToEnd",this.range),o=this.stripLineBreaks(s.text),r=this.findNodeByPos(n,o.length,1),this.endContainer=r.el,this.endOffset=r.offset}return t.prototype.select=function(){return this.range.select()},t.prototype.stripLineBreaks=function(t){return t.replace(/\r\n/g,"")},t.prototype.findNodeByPos=function(t,e,n){var r,o;return null==n&&(n=0),o={length:0,el:0,offset:0},(r=function(t,e,n,o){var i,s,a,h,g;for(h=t.childNodes,g=[],s=0,a=h.length;a>s;s++)if(i=h[s],!o.found)if(3===i.nodeType){if(o.length+i.length+n>e){o.found=!0,o.el=i,o.offset=e-o.length;break}g.push(o.length+=i.length)}else g.push(r(i,e,n,o));return g})(t,e,n,o),o},t.prototype.getText=function(t){return t.innerText||t.nodeValue},t.prototype.setStart=function(t,n){var r;return this.getText(t).length>=n&&n>=0?(r=e.body.createTextRange(),3===t.nodeType&&(r.moveToElementText(t.parentNode),r.moveStart("character",n)),this.range.setEndPoint("StartToStart",r)):void 0},t.prototype.setEnd=function(t,n){var r;return this.getText(t).length>=n&&n>=0?(r=e.body.createTextRange(),3===t.nodeType&&(r.moveToElementText(t.parentNode),r.moveStart("character",n)),this.range.setEndPoint("EndToStart",r)):void 0},t}();var r;r=function(){function t(){this.selection=e.selection,this.ranges=[new n(this.selection)],this.init()}return t.prototype.init=function(){var t,e;return this.rangeCount=this.ranges.length,this.anchorNode=null!=(t=this.ranges[0])?t.startContainer:void 0,this.anchorOffset=null!=(e=this.ranges[0])?e.startOffset:void 0},t.prototype.getRangeAt=function(t){return this.ranges[t]},t.prototype.removeAllRanges=function(){return this.ranges=[],this.init()},t.prototype.addRange=function(t){var e,n,r,o,i;for(this.ranges.push(t),o=this.ranges,i=[],n=0,r=o.length;r>n;n++)e=o[n],i.push(e.select());return i},t}()}}(window,document);