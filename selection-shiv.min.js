!function(e,t){if(!e.getSelection&&t.selection){e.getSelection=function(){return new i},t.createRange=function(){return new n};var n;n=function(){function e(e){var t,n,i,o;this.selection=e,this.range=this.selection.createRange(),n=this.range.parentElement(),this.commonAncestorContainer=n,o=this.range.duplicate(),o.moveToElementText(n),t=this.range.text.length>0?0:1,o.setEndPoint("EndToStart",this.range),i=this.findNodeByPos(n,o.text.length,t),this.startContainer=i.el,this.startOffset=i.offset,o.setEndPoint("EndToEnd",this.range),i=this.findNodeByPos(n,o.text.length,1),this.endContainer=i.el,this.endOffset=i.offset}return e.prototype.findNodeByPos=function(e,t,n){var i,o;return null==n&&(n=0),o={length:0,el:0,offset:0},(i=function(e,t,n,o){var s,r,h,l,a;for(l=e.childNodes,a=[],r=0,h=l.length;h>r;r++)if(s=l[r],3===s.nodeType){if(o.length+s.nodeValue.length+n>t){o.el=s,o.offset=t-o.length;break}a.push(o.length+=s.nodeValue.length)}else a.push(i(s,t,n,o));return a})(e,t,n,o),o},e}();var i;i=function(){function e(){this.rangeCount=1,this.selection=t.selection,this.range=new n(this.selection)}return e.prototype.getRangeAt=function(){return this.range},e}()}}(window,document);